# Autosubmissions for Learn Ultra assignments (BETA)

This is an internal Blackboard CLI tool that creates file submissions in Learn Ultra assignments. This tool is built in Python with Selenium and and also leverages the Bb-rest-helper library to get assignment and student information.

The purpose of this tool is to facilitate the creation of multiple "demo" attempts with files that are required in RFP usability testing as well as easily populating demo courses.

## Current version

The current version has been tested Tested for Learn Saas Ultra versions: 3900.48

## Main features

- The tool reads from a csv file with a list of external course id and retrives a list of assignments and students. This makes the tool easier to run (no arguments) and allow to launch the process for several courses at once, as well as dividing up the task if needed.

- For each one of the assignments, it loops over the student users and uses a selenium script to login, go to the assingment page, open a new attempt, input assingment text, upload an attachment and hit submit. It also manages the recipt popup.

- The tool generates a submission report that gathers: Timestamp,Course Id,Assignment Id,Username,Status. If the submissions fails, it takes an screenshot that would allow to troubleshoot the issue.

- all folders and files (except config files) will be generated by the tool to simplify setup.

- The tool currently takes between 30 and 40 seconds to create a submission,as it depends on Ultra UX and load times, it is still faster than you, and it does the work on your behalf, so dont complain ;)

## Known issues

- As with any tool of this nature, we can´t guarantee compatibility between versions as changes in the UX will break the tool. If useful, reasonable effort will be done to maintain the functionality.

- Custom login pages with radical differences to what we currently have in our demo servers could break the tool, also any integration that open modals in the course interface could cause the tool to fail.

- Some users seem to fail for no reason, but still accuracy is quite high.

## Best practices

- To run this script succesfully, we recommend to switch off any other programs running in the computer, as well as disabiling any "sleep" mode or screensaver.

- Default user password is set to use the same value as the username, this can be changed by simply editing line 53 in **app.py** to set a different value for variable **default_user_pass**

- If you cant affort to have your computer stuck for a very long time, consider running this from Raspberry Pi.

## Setup

As a prerequisite make sure that Python 3 is installed in the system. This script has been created and tested with Python 3.9.4.

1. Download or clone the repository, open a terminal and navigate to the root folder
2. In the root folder, create a python3 virtual environment.

    ```python
    python3 -m venv env
    ```

3. Activate the virtual environment.

    ```python
    source env/bin/activate
    ```

4. Install the dependencies from the requirements.txt file

    ```python
    pip3 install -r requirements.txt
    ```

5. Create a credentials file named **learn_config.json**, with the following structure. Do not change the name of this config file. You will need to create a new app in the developer portal as well as registering it on the target Learn Ultra instance with an user that has enough priviledges to get assignment and student information.IMPORTANT.Place this file in a folder named credentials.

    ```json
    {
    "url":"Learn server url",
    "key":"Learn key",
    "secret":"Learn secret"
    }
    ```

6. Create an app configuration file named **app_config.json** in the root folder. This file will include the sumbission text and the path to the sumbission file. The file has the following structure

    ```json
    {
    "submission_text":"submission text",
    "path_to_file":"./files/test.docx"
    }
    ```

7. Create a csv file named **course_external_id.csv** in the root folder of the application, in this file include all the course external ids for the courses that you wish to run through this tool

    ```bash
    # course_external_id.csv

    course_external_id
    course_001
    course_002
    course_003
    ```

8. For Selenium to work, you will need to dowload the right version of the chrome driver, you should check your version of chrome and search for the version of the chromedriver that matches with your version of Chrome. You can find the drivers here <https://chromedriver.chromium.org/downloads> . Note that I have included the version for Chrome 105 that I am using at the moment. The driver needs to be in the root folder.

9. Once done using the tool, deactivate the virtual environment

    ```python
    deactivate
    ```

## Usage

Usage has been greatly simplified, first make sure that you have completed all configuration steps.

1. Install python3.
2. Create virtual environment and activate it.
3. Install dependencies from **requeriments.txt** file.
4. Create **learn_config.json** under a ./credentials folder.
5. Create the **app_config.json** file under root.
6. Create **course_external_id.csv** under root.
7. Donwload the right version of the Chrome driver.

Once you have double check the prerequisites, run the tool with the simple command

```python
python3 app.py
```

The app will run, creating the "submissions.csv" report and adding lines accordingly as the attempts are created.

## Usage on a Rasbperri Pi

Using this tool in a Raspberri Pi is nice, as it has low power consumption and can be left unattended for long periods of time while the scripts are running, also, it won´t interfere with your day to day activities in your main computer. The usage is pretty much the same, except for two configurations.

1. Chromedriver needs to be installed differently, you need to open a terminal and type

    ```bash
    sudo apt-get install chromium-chromedriver
    ```
    
2. Then you need to edit **Auto_Submission.py** and remove the path to the driver, so it should be

    ```python
    #line 76`
    
    self.driver = webdriver.Chrome()
    ```

3. Finally, as the Pi is way less powerful than the computer, you need to give it a bit more time before the timeout, so edit line 77 to change the value from 10 to 30

    ```python
    #line 77
    
    self.wait = WebDriverWait(self.driver,30, poll_frequency=5)
    ```

With these changes, usage is the same as in the computer.
